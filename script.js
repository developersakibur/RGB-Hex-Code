let wrapper,hueThumb,shadePicker,shadeCanvas,bufferCanvas,colorView,cpBtn,cpMsg,color={hue:100,saturation:100,light:100,hex:"#FFFFFF"};function hueThumbDragStart(e){window.addEventListener("touchmove",hueThumbDragging),window.addEventListener("mousemove",hueThumbDragging),window.addEventListener("touchend",hueThumbDragEnd),window.addEventListener("mouseup",hueThumbDragEnd)}function hueThumbDragEnd(e){window.removeEventListener("touchmove",hueThumbDragging),window.removeEventListener("mousemove",hueThumbDragging),window.removeEventListener("touchend",hueThumbDragEnd),window.removeEventListener("mouseup",hueThumbDragEnd)}function shadeThumbDragStart(){window.addEventListener("touchmove",shadeThumbDragging),window.addEventListener("mousemove",shadeThumbDragging),window.addEventListener("touchend",shadeThumbDragEnd),window.addEventListener("mouseup",shadeThumbDragEnd)}function shadeThumbDragEnd(){window.removeEventListener("touchmove",shadeThumbDragging),window.removeEventListener("mousemove",shadeThumbDragging),window.removeEventListener("touchend",shadeThumbDragEnd),window.removeEventListener("mouseup",shadeThumbDragEnd)}function hueThumbDragging(e){let t=0,o=0,n=hueThumb.getBoundingClientRect();"touchmove"==e.type?(t=e.touches[0].clientX-n.x,o=e.touches[0].clientY-n.y):(t=e.clientX-n.x,o=e.clientY-n.y);let a=Math.atan2(o-n.height/2,t-n.width/2)/(2*Math.PI);a<0&&(a+=1),hue=Math.floor(360*a),setTimeout((()=>{drawShade(hue)}),0),hueThumb.style.setProperty("--v",a),wrapper.style.setProperty("--hue",hue),color.hue=hue,updateColor()}function shadeThumbDragging(e){let t=0,o=0,n=shadePicker.getBoundingClientRect();"touchmove"==e.type?(t=e.touches[0].clientX-n.x,o=e.touches[0].clientY-n.y):(t=e.clientX-n.x,o=e.clientY-n.y);let a=t/n.width,r=o/n.height;a=clamp(a,0,1),r=clamp(r,0,1);let h=Math.floor(100*a),d=Math.floor((1-r)*(100-50*a));color.saturation=h,color.light=d,shadePicker.style.setProperty("--vx",a),shadePicker.style.setProperty("--vy",r),wrapper.style.setProperty("--sat",h+"%"),wrapper.style.setProperty("--light",d+"%"),updateColor()}window.onload=()=>{wrapper=document.querySelector(".wrapper"),hueThumb=document.querySelector(".hue-thumb"),shadePicker=document.querySelector(".shade-picker"),shadeCanvas=document.querySelector("#shade"),colorView=document.querySelector(".color"),cpBtn=document.querySelector(".copy-btn"),cpMsg=document.querySelector(".tost");let e=document.querySelector(".hue-thumb .thumb"),t=document.querySelector(".shade-thumb .thumb");bufferCanvas=document.createElement("canvas"),e.addEventListener("touchstart",hueThumbDragStart),e.addEventListener("mousedown",hueThumbDragStart),t.addEventListener("touchstart",shadeThumbDragStart),t.addEventListener("mousedown",shadeThumbDragStart),drawShade(0),updateColor(),tostMsg=document.querySelector(".tost"),tostMsg.remove()};const clamp=(e,t,o)=>Math.min(o,Math.max(t,e));function drawShade(e){let t=shadePicker.getBoundingClientRect();shadeCanvas.width=t.width,shadeCanvas.height=t.height,bufferCanvas.width=t.width,bufferCanvas.height=t.height;let o=bufferCanvas.getContext("2d"),n=Math.round(shadeCanvas.height/100);for(let t=0;t<shadeCanvas.height/n;t++){var a=o.createLinearGradient(0,0,shadeCanvas.width,0);let r=100-t*n*100/shadeCanvas.height,h=50-t*n*50/shadeCanvas.height;a.addColorStop(0,`hsl(${e},  0%,${r}%)`),a.addColorStop(1,`hsl(${e},100%,${h}%)`),o.fillStyle=a,o.beginPath(),o.fillRect(0,t*n,shadeCanvas.width,n)}shadeCanvas.getContext("2d").drawImage(bufferCanvas,0,0,shadeCanvas.width,shadeCanvas.height)}function updateColor(){color.light>50?colorView.style.color="#000":colorView.style.color="#fff",color.light>50?cpBtn.style.color="#000":cpBtn.style.color="#fff",color.light>50?cpMsg.style.color="#fff":cpMsg.style.color="#000",color.light>50?cpMsg.style.background="#000":cpMsg.style.background="#fff",color.hex=HSLToHex(color.hue,color.saturation,color.light),colorView.innerText=color.hex}function HSLToHex(e,t,o){t/=100,o/=100;let n=(1-Math.abs(2*o-1))*t,a=n*(1-Math.abs(e/60%2-1)),r=o-n/2,h=0,d=0,u=0;return 0<=e&&e<60?(h=n,d=a,u=0):60<=e&&e<120?(h=a,d=n,u=0):120<=e&&e<180?(h=0,d=n,u=a):180<=e&&e<240?(h=0,d=a,u=n):240<=e&&e<300?(h=a,d=0,u=n):300<=e&&e<360&&(h=n,d=0,u=a),h=Math.round(255*(h+r)).toString(16),d=Math.round(255*(d+r)).toString(16),u=Math.round(255*(u+r)).toString(16),1==h.length&&(h="0"+h),1==d.length&&(d="0"+d),1==u.length&&(u="0"+u),"#"+h+d+u}function copyToClipboard(){let e=color.hex.toUpperCase();const t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),document.body.append(tostMsg)}